@(repoCreationSettings: Form[controllers.Application.RepoCreation], userTeams: Seq[controllers.Application.Team])(implicit req: Request[AnyContent], messages: Messages)

@import views.html.helper.CSRF
@implicitFieldConstructor = @{ b3.vertical.fieldConstructor }

@main {

    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
        @b3.form(routes.Application.createRepo) {
            @CSRF.formField

            @b3.inputWrapped(
                "text",
                repoCreationSettings("name"),
                '_label -> "Repository name",
                'maxlength -> "100",
                'required -> true,
                'pattern -> "^[A-Za-z0-9_-]+$",
                'autofocus -> true) { input =>
                <div class="input-group" >
                    <span class="input-group-addon">
                        <img src="@lib.Bot.orgUser.getAvatarUrl&s=40" width="20" height="20" class="img-rounded"> @lib.Bot.org /</span>
                    @input
                </div>
            }


            <div class="form-group">
                <label for="teamId" class="control-label"><span class="octicon octicon-jersey"></span> GitHub Team for initial Admin rights</label>
                <select id="teamId" name="teamId" class="form-control">
                @for(t <- userTeams) {
                    <option value="@t.id" data-team-size="@t.size" data-team-name="@t.name" >@t.name (@t.size members)</option>
                }
                </select>
            </div>

            <script>
            $(document).ready(function() {
                function format(team) {
                    var t = $(team.element);
                    return "<strong>" + t.data('team-name') + "</strong> <small>(" + t.data('team-size') + " members)</small>";
                }

                $("#teamId").select2({
                    formatResult: format,
                    formatSelection: format,
                    escapeMarkup: function(m) { return m; },
                    matcher: function(term, text, opt) {
                       return opt.data('team-name').toUpperCase().indexOf(term.toUpperCase())>=0;
                    }
                });
            });
            </script>

            @b3.submit('class -> s"btn btn-primary btn-lg") {
                <span class="octicon octicon-repo"></span> Create public repository
            }
        }
        </div>

        <div class="col-md-3"></div>
    </div>
}